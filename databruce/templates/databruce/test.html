{% extends "databruce/base.html" %}
{% comment %} {% load static %}
{% block title %}
  Test
{% endblock title %}
{% block extrajs %}
  <link href="https://cdn.datatables.net/columncontrol/1.0.7/css/columnControl.dataTables.min.css" rel="stylesheet">
  <script src="https://cdn.datatables.net/columncontrol/1.0.7/js/dataTables.columnControl.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/htmx.org@2.0.7/dist/htmx.min.js"></script>
{% endblock extrajs %}
{% block content %}
  <div class="text-2xl">Songs</div>
  <div class="table-responsive">
    <table id="myTable" width="100%" class="table table-hover display">
      <thead>
        <tr>
          <th class="all" scope="col">Date</th>
          <th class="all" scope="col">Act</th>
          <th class="min-tablet-l" scope="col">Venue</th>
          <th class="min-tablet-l" scope="col">Tour</th>
          <th class="min-tablet-l" scope="col">Position</th>
          <th class="min-tablet-l" scope="col">Gap</th>
          <th class="min-tablet-l" scope="col">Prev</th>
          <th class="min-tablet-l" scope="col">Next</th>
          <th class="min-tablet-l text-nowrap" scope="col">Note</th>
        </tr>
      </thead>
    </table>
  </div>
  <script>
    $(document).ready(function() {
      var table = $('#myTable').DataTable(
        {
          layout: getDatatableLayout([1,2,3,4,5,6,7,8]),
          serverSide: true,
          ajax: {
            'url': '/api/v1/songspage/?id=164&format=datatables',
          },
          columns: [
            {'data': 'event.date', 'name': 'event.date'},
            {'data': 'artist_name', 'name': 'artist'},
            {'data': 'venue_name'},
            {'data': 'tour_name'},
            {'data': 'position'},
            {'data': 'gap'},
            {'data': 'prev'},
            {'data': 'next'},
            {'data': 'note'},
          ],
          "initComplete": function( settings, json ) {
              htmx.process('#myTable');
          },
        }
      );
    });

    document.body.addEventListener('htmx:afterRequest', function(evt) {
        table.ajax.reload(function() {
            htmx.process('#myTable');
        }, false)
    });
</script>
{% endblock content %} {% endcomment %}
{% block title %}
  Reset Password
{% endblock title %}
{% block content %}
  <div class="card col-12 col-lg-4 mx-auto">
    <div class="card-header">Password Change</div>
    <div class="card-body">
      <div class="row">
        {% if validlink %}
          <form method="post">
            {% csrf_token %}
            <fieldset class="module aligned">
              <input class="hidden"
                     autocomplete="username"
                     value="{{ form.user.get_username }}">
              {% for field in form %}
                <div class="row mb-2">
                  <label class="form-label text-sm" for="{{ field.id_for_label }}">{{ field.label }}</label>
                  {% if field.errors %}
                    <br>
                    <span class="text-sm text-danger">
                      {% for error in field.errors %}{{ error }}{% endfor %}
                    </span>
                  {% endif %}
                  <div class="mx-auto">{{ field }}</div>
                </div>
              {% endfor %}
            </fieldset>
            <div class="submit-row">
              <div class="col-12">
                <button class="btn btn-sm btn-primary" type="submit">Change Password</button>
              </div>
            </div>
          </form>
        {% else %}
          <p class="text-sm">
            The password reset link was invalid, possibly because it has already been used.  Please request a new password reset.
          </p>
        {% endif %}
      </div>
    </div>
  </div>
{% endblock content %}
